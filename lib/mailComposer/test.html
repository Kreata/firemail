<!doctype html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>mailComposer test</title>
        <script src="../../example/require.js"></script>
        <script>
        require(["./mailComposer"], function(mailComposer) {
            var mc = mailComposer();

            mc.setHeader("subject", "test message")

            mc.setText("hello world kuidas teil seal metsa sees kull ometi laheb? on mingit aimu ka juba? voi ei ole?");
            mc.setHtml("<p><b>hello world</b> kuidas teil seal metsa sees kull ometi laheb? on mingit aimu ka juba? voi ei ole? <img src=\"cid:testimg@firemail\"/></p>");
            mc.addAttachment({content: "tere tere", fileName: "j√µgeva.txt"});

            mc.addAttachment({
                contentId: "testimg@firemail",
                fileName: "tick.png",
                content: new Uint8Array([0x89,0x50,0x4E,0x47,0x0D,0x0A,0x1A,0x0A,0x00,0x00,0x00,0x0D,0x49,0x48,0x44,0x52,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x10,0x01,0x03,0x00,0x00,0x00,0x25,0x3D,0x6D,0x22,0x00,0x00,0x00,0x06,0x50,0x4C,0x54,0x45,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xA5,0xD9,0x9F,0xDD,0x00,0x00,0x00,0x33,0x49,0x44,0x41,0x54,0x78,0x9C,0x63,0xF8,0xFF,0x9F,0xE1,0xFF,0x5F,0x86,0xFF,0x9F,0x19,0x0E,0xB0,0x33,0xDC,0x3F,0xCC,0x70,0x7F,0x32,0xC3,0xCD,0xCD,0x0C,0x37,0x8D,0x19,0xEE,0x14,0x83,0xD0,0xBD,0xCF,0x0C,0xF7,0x81,0x52,0xCC,0x0C,0x0F,0xC0,0xE8,0xFF,0x7F,0x00,0x51,0x86,0x17,0x28,0xCE,0x5D,0x9B,0x50,0x00,0x00,0x00,0x00,0x49,0x45,0x4E,0x44,0xAE,0x42,0x60,0x82])
            })

            var s = "";
            mc.ondata = function(chunk){
                s+=chunk;
            }

            mc.onend = function(){
                console.log(s);
            }

            console.log("TEXT AND HTML AND 4 ATTACHMENTS")
            console.log(JSON.stringify(mc._buildBodyTree()))
            console.log(JSON.stringify(mc._flattenBodyTree()));
            mc.stream();
        });
        </script>
    </head>
    <body>
        <h1>test</h1>
    </body>
</html>
